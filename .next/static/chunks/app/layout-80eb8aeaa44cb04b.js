(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},2099:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=(0,a(5647).UU)("https://wbvdvxgdtnpuedqsyvyc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzI2OTc2NDgzLCJleHAiOjIwNDI1NTI0ODN9.Dx10LqwjcB1UB3tr6ZVJTKKnIX4S4itZED_jEFtUlFY")},4541:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,default:()=>c});var r=a(5155),i=a(2115),s=a(2099),l=a(9509);let n=(0,i.createContext)({}),o=()=>{let e=(0,i.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function c(e){let{children:t}=e,[a,o]=(0,i.useState)(null),[c,u]=(0,i.useState)(null),[d,h]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await s.N.auth.getSession();o(null!=(e=null==t?void 0:t.user)?e:null),(null==t?void 0:t.user)&&await v(t.user.id),h(!1)})();let{data:{subscription:e}}=s.N.auth.onAuthStateChange(async(e,t)=>{var a;o(null!=(a=null==t?void 0:t.user)?a:null),(null==t?void 0:t.user)?await v(t.user.id):u(null)});return()=>e.unsubscribe()},[]);let v=async e=>{try{let{data:i,error:l}=await s.N.from("profiles").select("*").eq("id",e).maybeSingle();if(l&&"PGRST116"!==l.code)return void console.error("Error fetching profile:",l);if(!i&&a){var t,r;let{data:i,error:l}=await s.N.from("profiles").insert({id:e,email:a.email,display_name:(null==(t=a.user_metadata)?void 0:t.display_name)||(null==(r=a.email)?void 0:r.split("@")[0]),subscription_status:"free"}).select().maybeSingle();l?console.error("Error creating profile:",l):u(i)}else u(i)}catch(e){console.error("Error in fetchProfile:",e)}},y=async(e,t)=>{let{data:a,error:r}=await s.N.auth.signInWithPassword({email:e,password:t});return{data:a,error:r}},w=async(e,t)=>{let{data:a,error:r}=await s.N.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(l.env.NEXT_PUBLIC_APP_URL,"/auth/callback")}});return{data:a,error:r}},m=async()=>{let{error:e}=await s.N.auth.signOut();return{error:e}};return(0,r.jsx)(n.Provider,{value:{user:a,profile:c,loading:d,signIn:y,signUp:w,signOut:m},children:t})}},4742:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,6874,23)),Promise.resolve().then(a.bind(a,3568)),Promise.resolve().then(a.t.bind(a,347,23)),Promise.resolve().then(a.bind(a,4541)),Promise.resolve().then(a.bind(a,9118))},5196:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},9118:(e,t,a)=>{"use strict";a.d(t,{default:()=>u});var r=a(5155),i=a(2115),s=a(5196),l=a(9946);let n=(0,l.A)("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),o=(0,l.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var c=a(3568);function u(){let{title:e="ココロトリックスラボ - 心理テスト・診断アプリ",text:t="TikTokで人気の心理テスト・星座テスト・恋愛テストが楽しめる診断アプリ！あなたも試してみませんか？",url:a,className:l,children:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[d,h]=(0,i.useState)(!1),[v,y]=(0,i.useState)(!1);(0,i.useState)(()=>{"undefined"!=typeof navigator&&"share"in navigator&&y(!0)});let w=async()=>{let r={title:e,text:t,url:a||window.location.href};if("undefined"!=typeof navigator&&navigator.share&&navigator.canShare&&navigator.canShare(r))try{await navigator.share(r),c.Ay.success("シェアありがとうございます！")}catch(e){console.log("Share cancelled")}else try{await navigator.clipboard.writeText(window.location.href),h(!0),c.Ay.success("URLをコピーしました！"),setTimeout(()=>h(!1),2e3)}catch(e){c.Ay.error("コピーに失敗しました")}};return u||l?(0,r.jsx)("button",{onClick:w,className:l||"","aria-label":"このページをシェア",children:u||(0,r.jsx)("div",{className:"relative",children:d?(0,r.jsx)(s.A,{className:"w-5 h-5 text-green-500"}):v?(0,r.jsx)(n,{className:"w-5 h-5"}):(0,r.jsx)(o,{className:"w-5 h-5"})})}):(0,r.jsx)("button",{onClick:w,className:"fixed top-4 right-4 z-50 bg-white/90 backdrop-blur-sm text-brand-600 p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-110 active:scale-95 border border-brand-100","aria-label":"このページをシェア",children:(0,r.jsx)("div",{className:"relative",children:d?(0,r.jsx)(s.A,{className:"w-5 h-5 text-green-500"}):v?(0,r.jsx)(n,{className:"w-5 h-5"}):(0,r.jsx)(o,{className:"w-5 h-5"})})})}}},e=>{e.O(0,[690,647,95,568,441,964,358],()=>e(e.s=4742)),_N_E=e.O()}]);