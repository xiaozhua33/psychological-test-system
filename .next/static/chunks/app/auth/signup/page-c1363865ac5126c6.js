(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[778],{1264:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},2099:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(5647).UU)("https://wbvdvxgdtnpuedqsyvyc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzI2OTc2NDgzLCJleHAiOjIwNDI1NTI0ODN9.Dx10LqwjcB1UB3tr6ZVJTKKnIX4S4itZED_jEFtUlFY")},2657:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2919:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},3149:(e,t,s)=>{Promise.resolve().then(s.bind(s,4820))},4541:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,default:()=>d});var r=s(5155),a=s(2115),l=s(2099),i=s(9509);let n=(0,a.createContext)({}),c=()=>{let e=(0,a.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function d(e){let{children:t}=e,[s,c]=(0,a.useState)(null),[d,o]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await l.N.auth.getSession();c(null!=(e=null==t?void 0:t.user)?e:null),(null==t?void 0:t.user)&&await x(t.user.id),m(!1)})();let{data:{subscription:e}}=l.N.auth.onAuthStateChange(async(e,t)=>{var s;c(null!=(s=null==t?void 0:t.user)?s:null),(null==t?void 0:t.user)?await x(t.user.id):o(null)});return()=>e.unsubscribe()},[]);let x=async e=>{try{let{data:a,error:i}=await l.N.from("profiles").select("*").eq("id",e).maybeSingle();if(i&&"PGRST116"!==i.code)return void console.error("Error fetching profile:",i);if(!a&&s){var t,r;let{data:a,error:i}=await l.N.from("profiles").insert({id:e,email:s.email,display_name:(null==(t=s.user_metadata)?void 0:t.display_name)||(null==(r=s.email)?void 0:r.split("@")[0]),subscription_status:"free"}).select().maybeSingle();i?console.error("Error creating profile:",i):o(a)}else o(a)}catch(e){console.error("Error in fetchProfile:",e)}},h=async(e,t)=>{let{data:s,error:r}=await l.N.auth.signInWithPassword({email:e,password:t});return{data:s,error:r}},p=async(e,t)=>{let{data:s,error:r}=await l.N.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(i.env.NEXT_PUBLIC_APP_URL,"/auth/callback")}});return{data:s,error:r}},y=async()=>{let{error:e}=await l.N.auth.signOut();return{error:e}};return(0,r.jsx)(n.Provider,{value:{user:s,profile:d,loading:u,signIn:h,signUp:p,signOut:y},children:t})}},4615:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(5155),a=s(6874),l=s.n(a),i=s(6766),n=s(1007),c=s(4835),d=s(4541);function o(){let{user:e,profile:t,signOut:s}=(0,d.A)(),a=async()=>{await s()};return(0,r.jsx)("header",{className:"bg-white/95 backdrop-blur-sm border-b border-purple-100 sticky top-0 z-40",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(l(),{href:"/",className:"flex items-center space-x-2 group",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(i.default,{src:"/images/logo.png",alt:"ココロトリックスラボ",width:40,height:40,className:"group-hover:scale-105 transition-transform"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold gradient-text group-hover:scale-105 transition-transform",children:"ココロトリックスラボ"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 hidden sm:block",children:"心理テスト・診断アプリ"})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:e?(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(l(),{href:"/mypage",className:"flex items-center space-x-2 text-gray-600 hover:text-brand-600 transition-colors",children:[(0,r.jsx)(n.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"hidden sm:inline text-sm",children:(null==t?void 0:t.display_name)||"マイページ"})]}),(null==t?void 0:t.subscription_status)==="unlimited"&&(0,r.jsx)("span",{className:"px-2 py-1 bg-gradient-to-r from-yellow-400 to-orange-400 text-white text-xs font-medium rounded-full",children:"無制限"}),(0,r.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors p-2","aria-label":"ログアウト",children:(0,r.jsx)(c.A,{className:"w-4 h-4"})})]}):(0,r.jsx)(l(),{href:"/auth/login",className:"btn-primary text-sm px-4 py-2",children:"ログイン"})})]})})})}},4820:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(5155),a=s(2115),l=s(6874),i=s.n(l),n=s(4541),c=s(4615),d=s(1264),o=s(2919),u=s(8749),m=s(2657),x=s(3568);function h(){let[e,t]=(0,a.useState)(""),[s,l]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[y,b]=(0,a.useState)(!1),[f,v]=(0,a.useState)(!1),[g,N]=(0,a.useState)(!1),{signUp:j}=(0,n.A)(),w=async t=>{if(t.preventDefault(),s!==h)return void x.Ay.error("パスワードが一致しません");if(s.length<6)return void x.Ay.error("パスワードは6文字以上で入力してください");N(!0);try{let{error:t}=await j(e,s);t?t.message.includes("already registered")?x.Ay.error("このメールアドレスは既に登録されています"):x.Ay.error("登録に失敗しました"):x.Ay.success("登録成功！メールを確認してアカウントを有効化してください。")}catch(e){x.Ay.error("登録に失敗しました")}finally{N(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen",children:[(0,r.jsx)(c.A,{}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold gradient-text mb-2",children:"新規登録"}),(0,r.jsx)("p",{className:"text-gray-600",children:"無料でアカウントを作成してテストを楽しみましょう"})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"メールアドレス"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all",placeholder:"your@email.com",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"パスワード"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(o.A,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{id:"password",type:y?"text":"password",value:s,onChange:e=>l(e.target.value),className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all",placeholder:"6文字以上のパスワード",required:!0}),(0,r.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!y),children:y?(0,r.jsx)(u.A,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,r.jsx)(m.A,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"パスワード確認"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(o.A,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{id:"confirmPassword",type:f?"text":"password",value:h,onChange:e=>p(e.target.value),className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent transition-all",placeholder:"パスワードを再入力",required:!0}),(0,r.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>v(!f),children:f?(0,r.jsx)(u.A,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,r.jsx)(m.A,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),(0,r.jsx)("button",{type:"submit",disabled:g,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:g?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"登録中..."]}):"アカウント作成"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["既にアカウントをお持ちの方はこちら",(0,r.jsx)(i(),{href:"/auth/login",className:"text-brand-600 hover:text-brand-700 font-medium ml-1",children:"ログイン"})]})})]})]})})]})}},8749:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])}},e=>{e.O(0,[647,95,46,568,441,964,358],()=>e(e.s=3149)),_N_E=e.O()}]);